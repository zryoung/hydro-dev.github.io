(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{546:function(s,a,t){"use strict";t.r(a);var e=t(1),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"维护"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#维护"}},[s._v("#")]),s._v(" 维护")]),s._v(" "),t("h2",{attrs:{id:"pm2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pm2"}},[s._v("#")]),s._v(" PM2")]),s._v(" "),t("p",[s._v("使用一键安装脚本安装的 Hydro 使用 PM2 对进程进行管理。")]),s._v(" "),t("h3",{attrs:{id:"进程名称"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#进程名称"}},[s._v("#")]),s._v(" 进程名称")]),s._v(" "),t("p",[s._v("可以通过下面的指令查看当前 PM2 正在管理的所有进程。")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("pm2 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("一键安装脚本默认会创建下面几个进程：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("hydrooj")]),s._v("： Hydro 主进程")]),s._v(" "),t("li",[t("code",[s._v("hydro-sandbox")]),s._v("： Hydro 评测沙箱")]),s._v(" "),t("li",[t("code",[s._v("mongodb")]),s._v("： MongoDB 数据库")])]),s._v(" "),t("p",[s._v("后文的指令中将用 "),t("code",[s._v("<name>")]),s._v(" 替代此处的进程名称，用 "),t("code",[s._v("<id>")]),s._v(" 替代进程 ID（进程 ID 可通过 "),t("code",[s._v("pm2 ls")]),s._v(" 查看）。（尖括号同样需要替换）")]),s._v(" "),t("h3",{attrs:{id:"pm2-基本指令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#pm2-基本指令"}},[s._v("#")]),s._v(" PM2 基本指令")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("pm2 start "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动进程")]),s._v("\npm2 stop "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭进程")]),s._v("\npm2 restart "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启进程")]),s._v("\npm2 del "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除进程")]),s._v("\npm2 log "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看进程日志")]),s._v("\npm2 log "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" --lines"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看该进程的后 100 行日志")]),s._v("\npm2 start "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"<command>"')]),s._v(" --name "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建名为 <name> 的进程，进程执行内容为 <command>")]),s._v("\npm2 attach "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("id"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 与进程交互")]),s._v("\npm2 save "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存对 PM2 进行的修改（在添加、修改、删除进程后需要执行该指令）")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("Hydro 主进程同样支持多进程启动。")]),s._v(" "),t("div",{staticClass:"custom-block warning"},[t("p",{staticClass:"custom-block-title"},[s._v("Note")]),s._v(" "),t("p",[s._v("请不要盲目使用多进程启动 Hydro，在低端设备上会降低性能且成倍提高内存占用。")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[s._v("pm2 start hydrooj -i "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以 n 进程启动 Hydro 主进程")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"更新"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更新"}},[s._v("#")]),s._v(" 更新")]),s._v(" "),t("p",[s._v("Hydro 系统会不定期发布更新，可以使用下面的命令获取更新。")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yarn")]),s._v(" global upgrade-interactive --latest "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在交互式界面中选择想要更新的组件")]),s._v("\npm2 restart hydrooj "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 更新完后需重启 hydrooj")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])])}),[],!1,null,null,null);a.default=r.exports}}]);